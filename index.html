<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="stylesIndex/style.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200&icon_names=arrow_forward" />
    <title>Formulário</title>
</head>
<body>
    <form onsubmit="verificarCadastro(event); return false" class="formulario">
        <div class="foto">
            
        </div>
            <fieldset class="campos">
                <legend> Ficha de Triagem</legend>
                <label for="nome">
                Nome:
                <input type="text" id="nome" placeholder="Nome" class="nomeInput" required>
                </label>
                <label for="CPF">
                CPF:
                <input type="text" id="CPF" placeholder="000.000.000-00" maxlength="14" class="CPFinput" oninput="formatarCPF()" required>
                </label>
                <label for="sintomas">
                Sintomas:<textarea name="sintomas" id="sintomas" placeholder="Digite os sintomas do Paciente" minlength="5" maxlength="100" class="textInput" required></textarea>
                </label>
                <div id="resultados"></div>
                <div class="btn-father"> 
                <button onclick="verificarCadastro()">Verificar</button>
                </div>
            </fieldset>
        </form>
    <script>
        function formatarCPF(){
            const cpfField = document.getElementById("CPF");
            let cpf = cpfField.value;

            cpf = cpf.replace(/\D/g, '');
            if (cpf.length <= 11){
                cpf = cpf.replace(/(\d{3})(\d)/, '$1.$2'); 
                cpf = cpf.replace(/(\d{3})(\d)/, '$1.$2'); 
                cpf = cpf.replace(/(\d{3})(\d{1,2})$/, '$1-$2');
            }
            cpfField.value = cpf;
        }

        function verificarCadastro(event){
            event.preventDefault();
            const resultado = document.getElementById('resultados');
            resultado.innerHTML = ' ';
            const nome = document.getElementById('nome').value;
            const CPF = document.getElementById('CPF').value;
            const sintomas = document.getElementById('sintomas').value;

            const cpfClear = CPF.replace(/\D/g, '');
        //Verificando tamanho do nome: 

        if(nome.length >= 3 && CPF.length === 14 && !isNaN(cpfClear) && sintomas.length >= 5 && sintomas.length <= 100 ){
           // resultado.innerHTML += '<p class="pass">✔️</p>'; 
           // resultado.innerHTML += '<p class="pass">✔️</p>';
           // resultado.innerHTML += '<p class="pass">✔️</p>';
            sessionStorage.setItem('nome', nome); 
            sessionStorage.setItem('CPF', CPF);
            sessionStorage.setItem('sintomas', sintomas);
            window.location.href = '/sintomas.html';

        }else{
         //  resultado.innerHTML += '<p class="fail">❌ Nome Possui menos de 2 letras.</p>';
         //  resultado.innerHTML +='<p class="fail"> ❌ CPF está muito curto.</p>';
         //  resultado.innerHTML += '<p class="fail"> ❌ Quantidade de caractéres insuficiente</p>';
            alert("Acesso NEGADO: Verifique as informações!");
        }
    }
    </script>
</body>
</html>